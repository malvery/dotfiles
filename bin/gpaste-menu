#!/bin/bash

_rofi() {
  rofi -format 'i:s' -dmenu -i -l 10 "$@"
}

print_history() {
  gpaste-client --oneline |
    while read -r Item; do
      # remove uuid's
      printf '%s\n' "${Item#* }"
    done | sed 's/^[ \t]*//' # Hide leading whitespace
}

clip=$(
  print_history | _rofi -p "Clipboard history" \
    -selected-row "${Index:-0}"
)
index=${clip%%:*}

[ -z "$index" ] && exit

gpaste-client --use-index select $index
