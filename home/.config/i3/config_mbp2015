set $mod Mod4

# Font for window titles. Will also be used by the bar unless a different font
# is used in the bar {} block below.
font pango:hack 0

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

# start a terminal
bindsym $mod+Shift+Return exec --no-startup-id lxterminal

# kill focused window
bindsym $mod+Shift+c kill

# start dmenu (a program launcher)
bindsym $mod+r				exec --no-startup-id rofi -show run 
bindsym $mod+Shift+d	exec --no-startup-id rofi -show windowcd
#bindsym $mod+Shift+d	exec --no-startup-id rofi -show drun

# change focus
bindsym $mod+h	focus left
bindsym $mod+j	focus down
bindsym $mod+k	focus up
bindsym $mod+l	focus right


# alternatively, you can use the cursor keys:
bindsym $mod+Left		focus left
bindsym $mod+Down		focus down
bindsym $mod+Up			focus up
bindsym $mod+Right	focus right

# move focused window
bindsym $mod+Shift+h	move left
bindsym $mod+Shift+j	move down
bindsym $mod+Shift+k	move up
bindsym $mod+Shift+l	move right


# alternatively, you can use the cursor keys:
bindsym $mod+Shift+Left		move left
bindsym $mod+Shift+Down		move down
bindsym $mod+Shift+Up			move up
bindsym $mod+Shift+Right	move right

# split in horizontal orientation
#bindsym $mod+h split h
bindsym $mod+Shift+b split h

# split in vertical orientation
#bindsym $mod+v split v
bindsym $mod+Shift+v split v

# enter fullscreen mode for the focused container
bindsym $mod+Shift+f fullscreen toggle

# change container layout (stacked, tabbed, toggle split)
bindsym $mod+Shift+s layout stacking
bindsym $mod+Shift+w layout toggle tabbed split
bindsym $mod+Shift+e layout toggle split

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle

# change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle

# focus the parent container
bindsym $mod+a focus parent

# focus the child container
#bindsym $mod+d focus child

# switch to workspace
bindsym $mod+1 workspace 1
bindsym $mod+2 workspace 2
bindsym $mod+3 workspace 3
bindsym $mod+4 workspace 4
bindsym $mod+5 workspace 5
bindsym $mod+6 workspace 6
bindsym $mod+7 workspace 7
bindsym $mod+8 workspace 8
bindsym $mod+9 workspace 9
bindsym $mod+0 workspace 10

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace 1
bindsym $mod+Shift+2 move container to workspace 2
bindsym $mod+Shift+3 move container to workspace 3
bindsym $mod+Shift+4 move container to workspace 4
bindsym $mod+Shift+5 move container to workspace 5
bindsym $mod+Shift+6 move container to workspace 6
bindsym $mod+Shift+7 move container to workspace 7
bindsym $mod+Shift+8 move container to workspace 8
bindsym $mod+Shift+9 move container to workspace 9
bindsym $mod+Shift+0 move container to workspace 10

###############################################################################

# workspace hotkeys
bindsym $mod+g workspace 8
bindsym $mod+s workspace 9

# jump to urgent window
bindsym $mod+u [urgent=latest] focus

# focus switch
#bindsym $mod+Shift+Tab	focus left
#bindsym $mod+Tab				focus right
#bindsym $mod+Tab exec --no-startup-id  echo recent > /tmp/i3-window-switcher.pipe
bindsym $mod+Tab exec --no-startup-id pkill -SIGUSR1 -f i3-window-switcher

# switch between the current and the previously focused one
bindsym $mod+Escape workspace back_and_forth

# focus the output
bindsym $mod+"bracketleft"	focus output left
bindsym $mod+"bracketright" focus output right

# move the whole container to the output
bindsym $mod+Shift+"braceleft"	move workspace to output left
bindsym $mod+Shift+"braceright" move workspace to output right

# automatic back-and-forth when switching to the current workspace
#workspace_auto_back_and_forth yes

###############################################################################
set $file-manager "pcmanfm"
set $lock-manager "i3lock -c 000000"

# run apps
bindsym $mod+Shift+p		exec --no-startup-id $file-manager
bindsym $mod+Shift+F12	exec --no-startup-id $lock-manager

# brightnessctl
#bindsym XF86MonBrightnessUp		exec --no-startup-id "brightnessctl set +2%"
#bindsym XF86MonBrightnessDown exec --no-startup-id "brightnessctl set 2%-"
bindsym XF86MonBrightnessUp		exec --no-startup-id "light -A 2"
bindsym XF86MonBrightnessDown exec --no-startup-id "light -U 2"
bindsym XF86KbdBrightnessUp		exec --no-startup-id "light -s sysfs/leds/smc::kbd_backlight -A 50"
bindsym XF86KbdBrightnessDown exec --no-startup-id "light -s sysfs/leds/smc::kbd_backlight -U 50"



# volume ctl
bindsym XF86AudioRaiseVolume	exec --no-startup-id "amixer -D pulse set Master 5%+ unmute && pkill -RTMIN+10 i3blocks"
bindsym XF86AudioLowerVolume	exec --no-startup-id "amixer -D pulse set Master 5%- unmute && pkill -RTMIN+10 i3blocks"
bindsym XF86AudioMute					exec --no-startup-id "amixer -D pulse set Master toggle && pkill -RTMIN+10 i3blocks"

# MRIS2 ctl
bindsym XF86AudioPlay exec --no-startup-id "playerctl play-pause" 
bindsym XF86AudioPrev exec --no-startup-id "playerctl previous"
bindsym XF86AudioNext exec --no-startup-id "playerctl next"

###############################################################################

# set apps workspace
assign [class="Slack"] 9
assign [class="Thunderbird"] 9
#assign [class="TelegramDesktop"] 9

# set floating apps
for_window [class="Qiv"]									floating enable
for_window [class="Nitrogen"]							floating enable
for_window [class="Pavucontrol"]					floating enable
for_window [class="Blueman-manager"]			floating enable
for_window [class="Gnome-calculator"]			floating enable
for_window [class="Nm-connection-editor"]	floating enable

# set size
for_window [class="Thunderbird"] resize set 1100
for_window [class="Thunderbird"] move right

###############################################################################

# logout dialog
set $mode_system System: (l) lock, (Shift-s) suspend, (Shift-r) reboot, (Shift+p) shutdown
mode "$mode_system" {
	bindsym l				exec --no-startup-id $lock-manager,					mode "default"
	
	bindsym Shift+r exec --no-startup-id systemctl reboot,			mode "default"
	bindsym Shift+s exec --no-startup-id systemctl suspend,			mode "default"  
	bindsym Shift+p exec --no-startup-id systemctl poweroff -i, mode "default"

	# back to normal: Enter or Escape
	bindsym Return mode "default"
	bindsym Escape mode "default"
}
bindsym $mod+Shift+BackSpace mode "$mode_system"

# i3 dialog
set $config_i3 i3: (c) reload config, (r) restart, (Shift-e) logout
mode "$config_i3" {
	bindsym r	restart	
	bindsym c	reload
	bindsym Shift+e exec --no-startup-id i3-msg exit, mode "default"

	# back to normal: Enter or Escape
	bindsym Return mode "default"
	bindsym Escape mode "default"
}
bindsym $mod+Shift+i mode "$config_i3"

###############################################################################

# resize window (you can also use the mouse for that)
mode "resize" {
	bindsym h resize shrink width		15 px or 5 ppt
	bindsym j resize grow		height	15 px or 5 ppt
	bindsym k resize shrink height	15 px or 5 ppt
	bindsym l resize grow		width		15 px or 5 ppt

	# same bindings, but for the arrow keys
	bindsym Left	resize shrink		width		25 px or 5 ppt
	bindsym Down	resize grow			height	25 px or 5 ppt
	bindsym Up		resize shrink		height	25 px or 5 ppt
	bindsym Right resize grow			width		25 px or 5 ppt

	bindsym Shift+Left	resize shrink		width		100 px
	bindsym Shift+Down	resize grow			height	100 px
	bindsym Shift+Up		resize shrink		height	100 px
	bindsym Shift+Right resize grow			width		100 px

	# back to normal: Enter or Escape
	bindsym Return mode "default"
	bindsym Escape mode "default"
}

bindsym $mod+Shift+r mode "resize"

# Start i3bar to display a workspace bar (plus the system information i3status
# finds out, if available)
bar {
	i3bar_command		i3bar
	status_command \
		COLOR_H="#FF5500" \
		COLOR_M="#FFAE00" \
		COLOR_G="#A8FF00" \
		i3blocks -c ~/.config/i3/i3blocks.conf

	position				top
	font pango:			Ubuntu Mono Bold 10
	colors {
			statusline #aaaaaa 
			background #222222
	}
}

client.focused          #000000 #285577 #ffffff #2e9ef4   #285577
client.focused_inactive #000000 #5f676a #ffffff #484e50   #5f676a
client.unfocused        #333333 #222222 #888888 #292d2e   #222222
client.urgent           #2f343a #900000 #ffffff #900000   #900000
client.placeholder      #000000 #0c0c0c #ffffff #000000   #0c0c0c

###############################################################################
# autostart
exec --no-startup-id ~/.config/i3/autostart.sh
exec --no-startup-id setxkbmap -layout "us,ru(mac)" -option grp:caps_toggle

# after each restart
exec_always --no-startup-id ( killall kbdd || true ) && kbdd
exec_always --no-startup-id ~/.config/i3/i3-window-switcher.py
